<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>アクセスログ実験ページ</title>
  <meta name="description" content="Cloudflare Pages でアクセスログを確認するテストページ" />
</head>
<body>
  <h1>アクセスログ実験</h1>
  <p>このページを検索から開くと、リファラがログに記録されます。</p>

  <!-- ここにスクリプトを入れる -->
  <script>
  (function(){
    var endpoint = "/log";
    var ref = document.referrer || "";        // ここに“検索結果やリンク元”が入る場合がある
    var url = endpoint
      + "?u=" + encodeURIComponent(location.href)   // 開かれた自ページのURL
      + "&r=" + encodeURIComponent(ref);            // 本来の流入元（あれば）

    // 互換性の高い画像ビーコン
    var img = new Image();
    img.src = url;

    // ページ離脱時も確実に飛ばしたいなら追加（任意）
    // navigator.sendBeacon(endpoint, JSON.stringify({u: location.href, r: ref}));
  })();
  </script>
</body>
</html>
